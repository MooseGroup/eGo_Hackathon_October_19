# Vehicle API

## Docker

### Build

Execute the following command from project's root directory:

```bash
docker build -t vehicle-api .
```

### Run

Execute the following command from project root:

```bash
docker-compose up
```

#### Environment variables

Before you run, you can set the following variables in your [.env](./.env) file, if needed.

| Name | Description | Example |
|------|-------------|---------|
| `ADMIN_API_KEY` | The key for the admin API. | `ego` |
| `LOCAL_DEVELOPMENT` | Indicates, if backend should be run in development mode or not. | `true` |
| `MAX_INFOTAINMENT_FILESIZE` | The maximum file size in bytes, for an infotainment image or video. | `16777216` |
| `MONGO_DB` | The name of the database inside the [MongoDB](https://www.mongodb.com/) server. | `vehicle_api` |
| `MONGO_HOST` | The host address or IP of the [MongoDB](https://www.mongodb.com/) database server. | `mongo` |
| `MONGO_OPTIONS` | Additional options for connecting to the [MongoDB](https://www.mongodb.com/) database server. | `?useNewUrlParser=true` |
| `MONGO_PASSWORD` | Password for the [MongoDB](https://www.mongodb.com/) database. | `m05091979` |
| `MONGO_PORT` | The TCP port of the [MongoDB](https://www.mongodb.com/) database server. | `27017` |
| `MONGO_USER` | Username for the [MongoDB](https://www.mongodb.com/) database. | `tanja` |

### Documentation

* [Postman](https://www.getpostman.com/): [doc/vehicle-api.postman_collection.json](./doc/vehicle-api.postman_collection.json)
* [REST Client for Visual Studio Code](https://marketplace.visualstudio.com/items?itemName=humao.rest-client): [.vscode/http](./.vscode/http)
* [Swagger](https://swagger.io/): http://localhost/swagger

### Demo application

To access the demo application, simply open http://localhost:8080/ in your web browser.

The [admin](#admin) section describes, how to create one or more test vehicles for the API and web application.

## Admin

Define an admin API key in `ADMIN_API_KEY` environment variable.

### Create vehicle

#### Request

```http
POST http://localhost/api/admin/vehicles
X-Api-Key: <ADMIN_API_KEY>

```

#### Response

```http
HTTP/1.1 200 OK
X-Powered-By: Vehicle API by e.GO
Access-Control-Allow-Origin: *
Access-Control-Allow-Headers: *,Content-Type,X-Api-Key
Access-Control-Allow-Methods: *,GET,POST,PUT,DELETE,PATCH
X-Tm-Mk: 1979-09-05 23:09
Last-Modified: Thu, 09 May 2019 17:46:16 GMT
Content-Type: application/json; charset=utf-8
Content-Length: 158
Date: Thu, 09 May 2019 17:46:16 GMT
Connection: close

{
  "_id": "5cd467683c9a12057c2a3094",
  "uuid": "e415d6da-3900-4275-b92c-968964b4fb34",
  "__v": 0
}
```

### Get vehicles

#### Request

```http
GET http://localhost/api/admin/vehicles
X-Api-Key: <ADMIN_API_KEY>

```

#### Response

```http
HTTP/1.1 200 OK
X-Powered-By: Vehicle API by e.GO
Access-Control-Allow-Origin: *
Access-Control-Allow-Headers: *,Content-Type,X-Api-Key
Access-Control-Allow-Methods: *,GET,POST,PUT,DELETE,PATCH
X-Tm-Mk: 1979-09-05 23:09
Last-Modified: Thu, 09 May 2019 17:47:41 GMT
Content-Type: application/json; charset=utf-8
Content-Length: 387
Date: Thu, 09 May 2019 17:47:41 GMT
Connection: close

[
  {
    "_id": "5cd467683c9a12057c2a3094",
    "uuid": "e415d6da-3900-4275-b92c-968964b4fb34",
    "__v": 0
  }
]

```

### Delete vehicle

#### Request

```http
DELETE http://localhost/api/admin/vehicles/e415d6da-3900-4275-b92c-968964b4fb34
X-Api-Key: <ADMIN_API_KEY>

```

#### Response

```http
HTTP/1.1 204 No Content
X-Powered-By: Vehicle API by e.GO
Access-Control-Allow-Origin: *
Access-Control-Allow-Headers: *,Content-Type,X-Api-Key
Access-Control-Allow-Methods: *,GET,POST,PUT,DELETE,PATCH
X-Tm-Mk: 1979-09-05 23:09
Last-Modified: Thu, 09 May 2019 17:50:47 GMT
Date: Thu, 09 May 2019 17:50:47 GMT
Connection: close

```

## Resources

### Modules

The application makes use of the following modules, e.g.:

* [@egodigital/egoose](https://github.com/egodigital/egoose)
* [@egodigital/express-controllers](https://github.com/egodigital/express-controllers)
* [swagger-jsdoc-express](https://github.com/egodigital/swagger-jsdoc-express)

## Credits

The project has been generated by [generator-ego](https://github.com/egodigital/generator-ego) for [Yeoman](http://yeoman.io/).
